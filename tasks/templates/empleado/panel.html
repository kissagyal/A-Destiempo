{% extends 'base/base.html' %}
{% load static %}

{% block title %}Panel de Empleado - A Destiempo{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row mb-4">
        <div class="col-12">
            <h1 class="text-gradient mb-3">
                <i class="fas fa-tachometer-alt me-2"></i>Panel de Empleado
            </h1>
            <p class="text-light" style="color: var(--text-light) !important;">Gestiona discos e instrumentos</p>
        </div>
    </div>

    <!-- Estadísticas rápidas -->
    <div class="row mb-4">
        <div class="col-md-3 mb-3">
            <div class="card bg-primary text-white">
                <div class="card-body text-center">
                    <h2 class="mb-0">{{ total_discos }}</h2>
                    <p class="mb-0">Discos</p>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="card bg-info text-white">
                <div class="card-body text-center">
                    <h2 class="mb-0">{{ total_instrumentos }}</h2>
                    <p class="mb-0">Instrumentos</p>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="card bg-success text-white">
                <div class="card-body text-center">
                    <h2 class="mb-0">{{ total_refacciones }}</h2>
                    <p class="mb-0">Refacciones</p>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="card bg-warning text-white">
                <div class="card-body text-center">
                    <h2 class="mb-0">{{ pedidos_pendientes }}</h2>
                    <p class="mb-0">Pedidos Pendientes</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Acceso rápido CRUD -->
    <div class="row mb-5">
        <div class="col-md-3 mb-3">
            <div class="card bg-primary text-white">
                <div class="card-body">
                    <h5 class="card-title">
                        <i class="fas fa-compact-disc me-2"></i>Gestionar Discos
                    </h5>
                    <p class="card-text" style="color: rgba(255, 255, 255, 0.9) !important;">Añadir, editar y administrar discos</p>
                    <div class="d-flex gap-2">
                        <a href="{% url 'crear_disco' %}" class="btn btn-light btn-sm">
                            <i class="fas fa-plus me-1"></i>Nuevo
                        </a>
                        <a href="{% url 'lista_discos_vendedor' %}" class="btn btn-light btn-sm">
                            <i class="fas fa-list me-1"></i>Listar
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="card bg-dark text-white border border-primary">
                <div class="card-body">
                    <h5 class="card-title">
                        <i class="fas fa-image me-2"></i>Gestor de Banner
                    </h5>
                    <p class="card-text" style="color: rgba(255, 255, 255, 0.9) !important;">Actualiza la imagen y textos del banner principal</p>
                    <div class="d-flex gap-2">
                        <a href="{% url 'gestor_banner' %}" class="btn btn-light btn-sm">
                            <i class="fas fa-external-link-alt me-1"></i>Abrir gestor
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="card bg-info text-white">
                <div class="card-body">
                    <h5 class="card-title">
                        <i class="fas fa-guitar me-2"></i>Gestionar Instrumentos
                    </h5>
                    <p class="card-text" style="color: rgba(255, 255, 255, 0.9) !important;">Añadir, editar y administrar instrumentos</p>
                    <div class="d-flex gap-2">
                        <a href="{% url 'crear_instrumento' %}" class="btn btn-light btn-sm">
                            <i class="fas fa-plus me-1"></i>Nuevo
                        </a>
                        <a href="{% url 'lista_instrumentos_vendedor' %}" class="btn btn-light btn-sm">
                            <i class="fas fa-list me-1"></i>Listar
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="card bg-success text-white">
                <div class="card-body">
                    <h5 class="card-title">
                        <i class="fas fa-cog me-2"></i>Gestionar Refacciones
                    </h5>
                    <p class="card-text" style="color: rgba(255, 255, 255, 0.9) !important;">Añadir, editar y administrar refacciones</p>
                    <div class="d-flex gap-2">
                        <a href="{% url 'crear_refaccion' %}" class="btn btn-light btn-sm">
                            <i class="fas fa-plus me-1"></i>Nuevo
                        </a>
                        <a href="{% url 'lista_refacciones_vendedor' %}" class="btn btn-light btn-sm">
                            <i class="fas fa-list me-1"></i>Listar
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="card bg-warning text-white">
                <div class="card-body">
                    <h5 class="card-title">
                        <i class="fas fa-chart-line me-2"></i>Reportes
                    </h5>
                    <p class="card-text" style="color: rgba(255, 255, 255, 0.9) !important;">Ganancias, ventas y estadísticas</p>
                    <div class="d-flex gap-2">
                        <a href="{% url 'panel_reportes' %}" class="btn btn-light btn-sm">
                            <i class="fas fa-chart-bar me-1"></i>Ver Reportes
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Gestión de pedidos y clientes -->
    <div class="row mb-5">
        <div class="col-md-6 mb-3">
            <div class="card bg-danger text-white">
                <div class="card-body">
                    <h5 class="card-title">
                        <i class="fas fa-shopping-bag me-2"></i>Gestionar Pedidos
                    </h5>
                    <p class="card-text" style="color: rgba(255, 255, 255, 0.9) !important;">Ver y gestionar pedidos pendientes</p>
                    <div class="d-flex gap-2">
                        <a href="{% url 'pedidos_pendientes' %}" class="btn btn-light btn-sm">
                            <i class="fas fa-list me-1"></i>Ver Pedidos
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-6 mb-3">
            <div class="card bg-secondary text-white">
                <div class="card-body">
                    <h5 class="card-title">
                        <i class="fas fa-users me-2"></i>Gestionar Clientes
                    </h5>
                    <p class="card-text" style="color: rgba(255, 255, 255, 0.9) !important;">Ver y gestionar clientes registrados</p>
                    <div class="d-flex gap-2">
                        <a href="{% url 'lista_clientes' %}" class="btn btn-light btn-sm">
                            <i class="fas fa-list me-1"></i>Ver Clientes
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- Productos recientes -->
    <div class="row">
        <div class="col-lg-4">
            <div class="card">
                <div class="card-header bg-secondary text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-music me-2"></i>Discos Recientes
                    </h5>
                </div>
                <div class="card-body">
                    {% if discos_recientes %}
                        {% for disco in discos_recientes %}
                        <div class="d-flex justify-content-between align-items-center mb-3 pb-3 border-bottom border-secondary">
                            <div class="d-flex align-items-center gap-3" style="flex: 1;">
                                <!-- Imagen del disco -->
                                <div style="width: 80px; height: 80px; flex-shrink: 0; border-radius: 8px; overflow: hidden; background: var(--dark-bg); border: 1px solid var(--border-color); display: flex; align-items: center; justify-content: center;">
                                    {% if disco.portada %}
                                        <img src="{{ disco.portada.url }}" alt="{{ disco.titulo }}" style="width: 100%; height: 100%; object-fit: cover;">
                                    {% else %}
                                        <div class="d-flex align-items-center justify-content-center h-100" style="color: var(--text-muted); width: 100%; height: 100%;">
                                            <i class="fas fa-compact-disc fa-2x"></i>
                                        </div>
                                    {% endif %}
                                </div>
                                <!-- Información del disco -->
                                <div style="flex: 1;">
                                    <h6 class="text-light mb-1" style="color: var(--text-light) !important;">{{ disco.titulo }}</h6>
                                    <small class="text-muted" style="color: var(--text-muted) !important;">{{ disco.artista.nombre }} - {{ disco.get_formato_display }}</small>
                                </div>
                            </div>
                            <div class="text-end" style="margin-left: 15px;">
                                <span class="price" style="color: var(--primary-color); font-weight: 600;">${{ disco.precio|floatformat:2 }}</span>
                                <br>
                                {% if disco.activo %}
                                    <span class="badge bg-success">Activo</span>
                                {% else %}
                                    <span class="badge bg-danger">Inactivo</span>
                                {% endif %}
                                <br>
                                <div class="mt-2 d-flex gap-1">
                                    <a href="{% url 'editar_disco' disco.id %}" class="btn btn-outline-primary btn-sm">
                                        <i class="fas fa-edit"></i>
                                    </a>
                                    <a href="{% url 'eliminar_disco' disco.id %}" class="btn btn-outline-danger btn-sm">
                                        <i class="fas fa-trash"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                        <div class="text-center">
                            <a href="{% url 'lista_discos_vendedor' %}" class="btn btn-outline-primary">
                                Ver Todos los Discos
                            </a>
                        </div>
                    {% else %}
                        <p class="text-muted text-center">No hay discos registrados</p>
                        <div class="text-center">
                            <a href="{% url 'crear_disco' %}" class="btn btn-primary">
                                <i class="fas fa-plus me-1"></i>Añadir Primer Disco
                            </a>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            <div class="card">
                <div class="card-header bg-secondary text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-guitar me-2"></i>Instrumentos Recientes
                    </h5>
                </div>
                <div class="card-body">
                    {% if instrumentos_recientes %}
                        {% for instrumento in instrumentos_recientes %}
                        <div class="d-flex justify-content-between align-items-center mb-3 pb-3 border-bottom border-secondary">
                            <div>
                                <h6 class="text-light mb-1">{{ instrumento.nombre }}</h6>
                                <small class="text-muted">{{ instrumento.marca }} - {{ instrumento.categoria.nombre }}</small>
                            </div>
                            <div class="text-end">
                                <span class="price">${{ instrumento.precio|floatformat:2 }}</span>
                                <br>
                                {% if instrumento.activo %}
                                    <span class="badge bg-success">Activo</span>
                                {% else %}
                                    <span class="badge bg-danger">Inactivo</span>
                                {% endif %}
                                <br>
                                <div class="mt-2 d-flex gap-1">
                                    <a href="{% url 'editar_instrumento' instrumento.id %}" class="btn btn-outline-primary btn-sm">
                                        <i class="fas fa-edit"></i>
                                    </a>
                                    <a href="{% url 'eliminar_instrumento' instrumento.id %}" class="btn btn-outline-danger btn-sm">
                                        <i class="fas fa-trash"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                        <p class="text-center" style="color: var(--text-muted) !important;">No hay instrumentos registrados</p>
                    {% endif %}
                </div>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="card">
                <div class="card-header bg-secondary text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-cog me-2"></i>Refacciones Recientes
                    </h5>
                </div>
                <div class="card-body">
                    {% if refacciones_recientes %}
                        {% for refaccion in refacciones_recientes %}
                        <div class="d-flex justify-content-between align-items-center mb-3 pb-3 border-bottom border-secondary">
                            <div>
                                <h6 class="text-light mb-1">{{ refaccion.nombre }}</h6>
                                <small class="text-muted">{{ refaccion.marca }} - {{ refaccion.categoria.nombre }}</small>
                            </div>
                            <div class="text-end">
                                <span class="price">${{ refaccion.precio|floatformat:2 }}</span>
                                <br>
                                {% if refaccion.activo %}
                                    <span class="badge bg-success">Activo</span>
                                {% else %}
                                    <span class="badge bg-danger">Inactivo</span>
                                {% endif %}
                                <br>
                                <div class="mt-2 d-flex gap-1">
                                    <a href="{% url 'editar_refaccion' refaccion.id %}" class="btn btn-outline-primary btn-sm">
                                        <i class="fas fa-edit"></i>
                                    </a>
                                    <a href="{% url 'eliminar_refaccion' refaccion.id %}" class="btn btn-outline-danger btn-sm">
                                        <i class="fas fa-trash"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                        <p class="text-center" style="color: var(--text-muted) !important;">No hay refacciones registradas</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- Enlaces útiles -->
    <div class="row mt-5">
        <div class="col-12">
            <div class="card">
                <div class="card-header bg-secondary text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-link me-2"></i>Enlaces Útiles
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <a href="{% url 'lista_discos_vendedor' %}" class="btn btn-outline-primary w-100">
                                <i class="fas fa-compact-disc me-2"></i>Ver Todos los Discos
                            </a>
                        </div>
                        <div class="col-md-4 mb-3">
                            <a href="{% url 'panel_reportes' %}" class="btn btn-outline-info w-100">
                                <i class="fas fa-chart-line me-2"></i>Ver Reportes
                            </a>
                        </div>
                        <div class="col-md-4 mb-3">
                            <a href="{% url 'pedidos_pendientes' %}" class="btn btn-outline-success w-100">
                                <i class="fas fa-shopping-bag me-2"></i>Ver Pedidos
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
